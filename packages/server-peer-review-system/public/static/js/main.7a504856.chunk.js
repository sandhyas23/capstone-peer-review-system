(window["webpackJsonpclient-peer-review-system"]=window["webpackJsonpclient-peer-review-system"]||[]).push([[0],{279:function(e,t,n){e.exports=n(508)},508:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),s=n(49),r=n.n(s),c=(n(284),n(17)),o=n(22),l=n(23),u=n(26),m=n(24),d=n(25),h=n(530),p=n(531),v=n(526),f=n(533),b=n(186),k=n(528),w=n(33),E=n.n(w),g=n(45),y=n(18),T=n.n(y),C=n(28),S=n.n(C),R=(n(71),n(97)),I=n(69),j=n(521),O=n(523),A=n(19),x=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleFile=function(){var e=Object(g.a)(E.a.mark((function e(t){var a,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new FileReader,i=t.target.files[0],0!==t.target.value.length?(a.onloadend=function(){var e=Object(g.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.setState({content:t.target.result,fileName:i.name});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.readAsText(i)):n.setState({content:n.state.content,fileName:n.state.fileName});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state={currentTask:n.props.currentTask,submissions:[],netId:n.props.netId,"assignment-name":n.props.currentTask["task-name"],content:"Upload a markdown file to view the submission",theInputKey:"",fileName:""},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){T.a.highlightAll()}},{key:"componentDidMount",value:function(){var e=this;fetch("/submissions/student/"+this.state.netId,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){var n=t.submissions.find((function(t,n,a){return t["assignment-name"]===e.state.currentTask["task-name"]}));"undefined"!==typeof n?e.setState({submissions:t.submissions,content:n.content,fileName:n.fileName}):e.setState({submissions:t.submissions})})),T.a.highlightAll()}},{key:"handleSubmit",value:function(){var e=this;if("undefined"===typeof(new A.a).get("user"))alert("session expired"),this.props.onclickLogout();else{var t=this,n={"assignment-name":this.state["assignment-name"],netId:this.state.netId,content:this.state.content,fileName:this.state.fileName,submittedOn:(new Date).toISOString()},a=this.state.submissions.findIndex((function(t){return t["assignment-name"]===e.state["assignment-name"]&&t.netId===e.state.netId}));a>=0?fetch("/submissions/"+this.state["assignment-name"]+"/student/"+this.state.netId,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(n)}).then((function(e){t.state.submissions.splice(a,1,n),t.setState({submissions:t.state.submissions})})):fetch("/submissions/"+this.state["assignment-name"]+"/student/"+this.state.netId,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(n)}).then((function(e){t.state.submissions.push(n);var a=Math.random().toString(36);t.setState({submissions:t.state.submissions,theInputKey:a})}))}}},{key:"render",value:function(){var e=this,t="",n="",a=this.state.submissions.find((function(t,n,a){return t["assignment-name"]===e.state["assignment-name"]&&t.netId===e.state.netId}));"undefined"===typeof a?t="Not Submitted":(t="Submitted",n=new Date(a.submittedOn).toLocaleString());var s=this.state.content,r=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:s}));return i.a.createElement(h.a.Row,null,i.a.createElement(h.a.Column,{computer:14},i.a.createElement(h.a.Row,null,i.a.createElement(f.a,{style:{boxShadow:"none"}},i.a.createElement(R.a,{ribbon:!0,icon:"star",content:"".concat(t," : ").concat(n),color:"blue"}),i.a.createElement("span",null,i.a.createElement(p.a,{textAlign:"center",as:"h4"},i.a.createElement(I.a,{name:"tag"}),this.state.currentTask["task-name"])))),i.a.createElement(h.a.Row,null,i.a.createElement(h.a.Column,null,i.a.createElement(v.a,{centered:"true"},i.a.createElement(f.a,{textAlign:"center"},i.a.createElement(v.a.Group,{centered:"true",widths:"equal"},i.a.createElement(v.a.Field,{inline:!0},i.a.createElement(R.a,{icon:"calendar alternate",content:"Due"}),i.a.createElement(j.a,{readOnly:!0},new Date(this.state.currentTask.due).toLocaleString())),i.a.createElement(v.a.Field,{inline:!0},i.a.createElement(R.a,{icon:"lock open",content:"Status"}),i.a.createElement(j.a,{readOnly:!0,style:{color:"green"}},"Open"))),i.a.createElement(v.a.Group,{centered:"true",widths:"equal"},i.a.createElement(v.a.Field,null,i.a.createElement(R.a,{icon:"file code",content:"Markdown Preview "}),i.a.createElement(R.a,{basic:!0},i.a.createElement(I.a,{name:"file"}),"Filename : ",this.state.fileName),i.a.createElement(f.a,{style:{overflow:"auto",minHeight:330,maxHeight:330,maxWidth:600,minWidth:200}},i.a.createElement(O.a,{readOnly:!0,style:{minHeight:300,minWidth:200},name:"content",value:this.state.content}))),i.a.createElement(v.a.Field,null,i.a.createElement(R.a,{icon:"code",content:"Code Preview"}),i.a.createElement(f.a,{style:{overflow:"auto",minHeight:330,maxHeight:330,maxWidth:600,minWidth:200},textAlign:"left"},r))),i.a.createElement("input",{type:"file",accept:".md",onChange:function(t){return e.handleFile(t)},key:this.state.theInputKey}),i.a.createElement(b.a,{icon:"file",content:"Submit",type:"button",color:"green",onClick:function(){return e.handleSubmit()},disabled:"Upload a markdown file to view the submission"===this.state.content})))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.currentTask===t.currentTask)return null;var n=t.submissions.find((function(t,n,a){return t["assignment-name"]===e.currentTask["task-name"]}));if("undefined"!==typeof n){var a=Math.random().toString(36),i=n.content,s=n.fileName;return{currentTask:e.currentTask,"assignment-name":e.currentTask["task-name"],content:i,fileName:s,theInputKey:a}}var r=Math.random().toString(36);return{currentTask:e.currentTask,"assignment-name":e.currentTask["task-name"],content:"Upload a markdown file to view the submission",fileName:"",theInputKey:r}}}]),t}(i.a.Component),H=n(529),D=n(532),N=n(524),P=n(527),G=n(139),W=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(){var e=Object(g.a)(E.a.mark((function e(t,a,i){var s,r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=t.target,r=s.value,o=s.name,n.setState(Object(c.a)({},o,r));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),n.state={currentTask:n.props.currentTask,studentsReview:n.props.reviews,netId:n.props.netId,"assignment-name":n.props.currentTask["peer-review-for"],content:"Click a review link to view the submission",totalQuestions:[],reviewTasks:n.props.reviewTasks,studentAssignment:n.props.studentAssignment,submissions:n.props.submissions,totalRubricsToReview:[],rubric:[],rubricName:""},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("/reviews/"+this.state["assignment-name"]+"/reviewer/"+this.state.netId,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){t.reviews.map((function(t,n,a){return e.setState({rubric:t.review.rubric}),[t.review.rubric.map((function(n,a,i){var s;return e.setState((s={},Object(c.a)(s,"pointGiven".concat(t["reviewer-id"]).concat(t["submitter-id"]).concat(n["rubric-name"]),n["points-given"]),Object(c.a)(s,"comment".concat(t["reviewer-id"]).concat(t["submitter-id"]).concat(n["rubric-name"]),n.comments),s))})),e.setState(Object(c.a)({},"submittedOn".concat(t["submitter-id"]).concat(t["reviewer-id"]),t.submittedOn))]}))})),T.a.highlightAll()}},{key:"componentDidUpdate",value:function(e,t){if(t["assignment-name"]!==this.state["assignment-name"]){var n=this;fetch("/reviews/"+this.state["assignment-name"]+"/reviewer/"+this.state.netId,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){e.reviews.map((function(e,t,a){return n.setState({rubric:e.review.rubric}),[e.review.rubric.map((function(t,a,i){var s;return n.setState((s={},Object(c.a)(s,"pointGiven".concat(e["reviewer-id"]).concat(e["submitter-id"]).concat(t["rubric-name"]),t["points-given"]),Object(c.a)(s,"comment".concat(e["reviewer-id"]).concat(e["submitter-id"]).concat(t["rubric-name"]),t.comments),s))})),n.setState(Object(c.a)({},"submittedOn".concat(e["submitter-id"]).concat(e["reviewer-id"]),e.submittedOn))]}))}))}T.a.highlightAll()}},{key:"handleItemClick",value:function(e,t){var n=this,a="",i=this.state.submissions.find((function(e,a,i){return e["assignment-name"]===n.state["assignment-name"]&&e.netId===t}));"undefined"!==typeof i&&(a=i.content);var s=this.state.currentTask.rubric;this.state.totalRubricsToReview.map((function(e,a,i){if(n.state["pointGiven".concat(n.state.netId).concat(t).concat(e["rubric-name"])]&&n.state["comment".concat(n.state.netId).concat(t).concat(e["rubric-name"])]){var s={"rubric-name":e["rubric-name"],"possible-points":e.points,"points-given":n.state["pointGiven".concat(n.state.netId).concat(t).concat(e["rubric-name"])],comments:n.state["comment".concat(n.state.netId).concat(t).concat(e["rubric-name"])]};n.state.rubric.splice(a,1,s)}}));this.setState({rubric:this.state.rubric,reviewNo:t,totalRubricsToReview:s,content:a})}},{key:"afterHandleChange",value:function(e,t,n){var a=this;this.handleChange(e,t,n).then((function(){var e={"rubric-name":t["rubric-name"],"possible-points":t.points,"points-given":a.state["pointGiven".concat(a.state.netId).concat(a.state.reviewNo).concat(t["rubric-name"])],comments:a.state["comment".concat(a.state.netId).concat(a.state.reviewNo).concat(t["rubric-name"])]};a.state.rubric.splice(n,1,e),a.setState({rubric:a.state.rubric,rubricName:t["rubric-name"],"possible-points":t.points})}))}},{key:"handleSubmit",value:function(e){var t=this;if("undefined"===typeof(new A.a).get("user"))alert("session expired"),this.props.onclickLogout();else if(this.state.rubric.filter((function(e,t,n){return parseInt(e["points-given"])>parseInt(e["possible-points"])||parseInt(e["points-given"])<0})).length>0)alert("Given points not valid. Please change them");else{for(var n=0,a=0;a<this.state.rubric.length;a++)n+=parseInt(this.state.rubric[a]["points-given"]);var i=this.state.studentsReview.findIndex((function(e,n,a){return e["assignment-name"]===t.state["assignment-name"]&&e["reviewer-id"]===t.state.netId&&e["submitter-id"]===t.state.reviewNo}));if(-1===i){var s={reviewerId:this.state.netId,"submitter-id":this.state.reviewNo,"assignment-name":this.state["assignment-name"],review:{"general-comments":"",rubric:this.state.rubric,"total-points":n}},r=this;fetch("/reviews/"+this.state["assignment-name"]+"/reviewer/"+this.state.netId+"/submitter/"+this.state.reviewNo,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(s)}).then((function(e){r.state.studentsReview.push(s),r.setState(Object(c.a)({studentsReview:r.state.studentsReview},"submittedOn".concat(r.state.reviewNo).concat(r.state.netId),new Date)),alert("submitted review for this submitter")}))}else{var o={reviewerId:this.state.netId,"submitter-id":this.state.reviewNo,"assignment-name":this.state["assignment-name"],review:{"general-comments":"",rubric:this.state.rubric},"total-points":n},l=this;fetch("/reviews/"+this.state["assignment-name"]+"/reviewer/"+this.state.netId+"/submitter/"+this.state.reviewNo,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(o)}).then((function(e){l.state.studentsReview.splice(i,1,o),l.setState(Object(c.a)({studentsReview:l.state.studentsReview},"submittedOn".concat(l.state.reviewNo).concat(l.state.netId),new Date)),alert("submitted review for this submitter")}))}}}},{key:"viewContent",value:function(){var e=this.state.content,t=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:e}));return i.a.createElement(f.a,{style:{overflow:"auto",minHeight:330,maxHeight:330,maxWidth:500,minWidth:200},textAlign:"left"},t)}},{key:"render",value:function(){for(var e,t=this,n=!0,a=this.state.totalRubricsToReview.length,s=0;s<this.state.totalRubricsToReview.length;s++)this.state.rubric[s]&&void 0!==this.state.rubric[s]["points-given"]&&void 0!==this.state.rubric[s].comments||(n=!1);a!==this.state.totalRubricsToReview.length&&(n=!1);var r=this.state.studentAssignment.find((function(e,n,a){return e["peer-review-for"]===t.state["assignment-name"]}));if("undefined"===typeof r)return"nothing to display";var c=r.studentsAssignment.find((function(e,n,a){return e.student===t.state.netId}));"undefined"!==typeof c&&(e=c.reviewees.map((function(e,n,a){return i.a.createElement(H.a.Item,{name:"Review".concat(n),active:e===t.state.reviewNo,as:"a",onClick:function(n){return t.handleItemClick(n,e)},key:"Review".concat(e).concat(n)},"Review".concat(n))})));var o=this.state.currentTask.instructions,l=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:o})),u=this.state.currentTask.rubric.map((function(e,t,n){var a=e.criteria,s=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:a}));return i.a.createElement(P.a.Row,{key:"row".concat(e["rubric-name"]).concat(t)},i.a.createElement(P.a.Cell,{key:"points".concat(e["rubric-name"]).concat(t)},e.points),i.a.createElement(P.a.Cell,{key:"rubric".concat(e["rubric-name"]).concat(t)},e["rubric-name"]),i.a.createElement(P.a.Cell,{key:"criteria".concat(e["rubric-name"]).concat(t)},s))})),m=this.state.totalRubricsToReview.map((function(e,n,a){return i.a.createElement(v.a.Group,{key:"rubric".concat(e["rubric-name"]).concat(n)},i.a.createElement(R.a,{tag:!0,content:e["rubric-name"]}),i.a.createElement(R.a,{content:e.points}),i.a.createElement(v.a.Input,{name:"pointGiven".concat(t.state.netId).concat(t.state.reviewNo).concat(e["rubric-name"]),type:"number",label:"Points",placeholder:"Points",width:4,min:"0",max:e.points,required:!0,onChange:function(a){return t.afterHandleChange(a,e,n)},key:"pointGiven".concat(t.state.netId).concat(t.state.reviewNo).concat(e["rubric-name"]),value:t.state["pointGiven".concat(t.state.netId).concat(t.state.reviewNo).concat(e["rubric-name"])]||""}),i.a.createElement(v.a.Input,{name:"comment".concat(t.state.netId).concat(t.state.reviewNo).concat(e["rubric-name"]),required:!0,label:"Comments",placeholder:"comments",width:10,onChange:function(a){return t.afterHandleChange(a,e,n)},key:"comment".concat(t.state.netId).concat(t.state.reviewNo).concat(e["rubric-name"]),value:t.state["comment".concat(t.state.netId).concat(t.state.reviewNo).concat(e["rubric-name"])]||""}))}));return i.a.createElement(h.a,{stackable:!0},i.a.createElement(h.a.Column,null,i.a.createElement(h.a.Row,null,i.a.createElement(f.a,{style:{boxShadow:"none"}},i.a.createElement("span",null,i.a.createElement(p.a,{textAlign:"center",as:"h4"},i.a.createElement(I.a,{name:"tag"}),this.state.currentTask["peer-review-for"])))),i.a.createElement(h.a.Row,null,i.a.createElement(v.a,{centered:"true"},i.a.createElement(f.a,{textAlign:"center"},i.a.createElement(v.a.Group,{centered:"true",widths:"equal"},i.a.createElement(v.a.Field,{inline:!0},i.a.createElement(R.a,{icon:"calendar alternate",content:"Due"}),i.a.createElement(j.a,{readOnly:!0},new Date(this.state.currentTask.due).toLocaleString())),i.a.createElement(v.a.Field,{inline:!0},i.a.createElement(R.a,{icon:"lock open",content:"Status"}),i.a.createElement(j.a,{readOnly:!0,style:{color:"green"}},"Open")))))),i.a.createElement(p.a,{textAlign:"center",as:"h4"},i.a.createElement(I.a,{name:"code"}),"Submit Review"),i.a.createElement("span",null," ",i.a.createElement(G.a,{trigger:i.a.createElement(b.a,null,"View Rubrics")},i.a.createElement(G.a.Header,null,"Rubrics"),i.a.createElement(G.a.Content,{scrolling:!0},i.a.createElement(G.a.Description,null,i.a.createElement(p.a,null,"Rubrics for ",this.state.currentTask["peer-review-for"]),i.a.createElement("div",null,"General Instructions: ",l),i.a.createElement(P.a,null,i.a.createElement(P.a.Header,null,i.a.createElement(P.a.Row,null,i.a.createElement(P.a.HeaderCell,null," Possible points"),i.a.createElement(P.a.HeaderCell,null," Rubric name"),i.a.createElement(P.a.HeaderCell,null," Criteria"))),i.a.createElement(P.a.Body,null,u)))))),i.a.createElement(h.a.Row,{columns:2},i.a.createElement(h.a,{celled:!0},i.a.createElement(h.a.Column,{width:8},i.a.createElement(H.a,{pointing:!0,secondary:!0},e),this.viewContent()),i.a.createElement(h.a.Column,{width:8},i.a.createElement(p.a,{textAlign:"center",as:"h4"},i.a.createElement(I.a,{name:"code"}),"Enter points here"),i.a.createElement("hr",null),i.a.createElement(f.a,{style:{overflow:"auto",minHeight:330,maxHeight:330,maxWidth:500,minWidth:200},textAlign:"left"},i.a.createElement(v.a,null,m,this.state.reviewNo?i.a.createElement(b.a,{icon:"file",content:"Submit",type:"button",color:"green",onClick:function(e){return t.handleSubmit(e)},disabled:!n||this.state.rubric.length<=0}):i.a.createElement("div",null,"Click on a review id to submit reviews")),"\xa0",this.state.reviewNo?this.state["submittedOn".concat(this.state.reviewNo).concat(this.state.netId)]?i.a.createElement("div",null,i.a.createElement(R.a,{ribbon:!0,icon:"star",content:"Submitted :\n                             ".concat(new Date(this.state["submittedOn".concat(this.state.reviewNo).concat(this.state.netId)]).toLocaleString()),color:"blue"})):i.a.createElement("div",null,i.a.createElement(R.a,{ribbon:!0,icon:"star",content:"Submitted : Not submitted",color:"blue"})):i.a.createElement("div",null)))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.currentTask===t.currentTask?null:{currentTask:e.currentTask,"assignment-name":e.currentTask["peer-review-for"],content:"Click a review link to view the submission",reviewTasks:e.reviewTasks,studentAssignment:e.studentAssignment,submissions:e.submissions}}}]),t}(i.a.Component),L=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={currentTask:n.props.currentTask,submissions:e.submissions,netId:n.props.netId,"assignment-name":n.props.currentTask["task-name"]},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){T.a.highlightAll()}},{key:"componentDidMount",value:function(){T.a.highlightAll()}},{key:"render",value:function(){var e=this,t="",n="",a=this.state.submissions.find((function(t,n,a){return t.netId===e.state.netId&&t["assignment-name"]===e.state["assignment-name"]}));"undefined"!==typeof a&&(t=a.content,n=a.fileName);var s="",r="",c=this.state.submissions.find((function(t,n,a){return t["assignment-name"]===e.state["assignment-name"]&&t.netId===e.state.netId}));"undefined"===typeof c?s="Not Submitted":(s="Submitted",r=new Date(c.submittedOn).toLocaleString());var o=t,l=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:o}));return i.a.createElement(h.a.Row,null,i.a.createElement(h.a.Column,{computer:14},i.a.createElement(h.a.Row,null,i.a.createElement(f.a,{style:{boxShadow:"none"}},i.a.createElement(R.a,{ribbon:!0,icon:"star",content:"".concat(s," : ").concat(r),color:"blue"}),i.a.createElement("span",null,i.a.createElement(p.a,{textAlign:"center",as:"h4"},i.a.createElement(I.a,{name:"tag"}),this.state.currentTask["task-name"])))),i.a.createElement(h.a.Row,null,i.a.createElement(h.a.Column,null,i.a.createElement(v.a,{centered:"true"},i.a.createElement(f.a,{textAlign:"center"},i.a.createElement(v.a.Group,{centered:"true",widths:"equal"},i.a.createElement(v.a.Field,{inline:!0},i.a.createElement(R.a,{icon:"calendar alternate",content:"Due"}),i.a.createElement(j.a,{readOnly:!0},new Date(this.state.currentTask.due).toLocaleString())),i.a.createElement(v.a.Field,{inline:!0},i.a.createElement(R.a,{icon:"lock open",content:"Status"}),i.a.createElement(j.a,{readOnly:!0,style:{color:"red"}},"Closed"))),i.a.createElement(v.a.Group,{centered:"true",widths:"equal"},i.a.createElement(v.a.Field,null,i.a.createElement(R.a,{icon:"file code",content:"Markdown Preview "}),i.a.createElement(R.a,{basic:!0},i.a.createElement(I.a,{name:"file"}),"Filename : ",n),i.a.createElement(f.a,{style:{overflow:"auto",minHeight:330,maxHeight:330,maxWidth:600,minWidth:200}},i.a.createElement(O.a,{readOnly:!0,style:{minHeight:300,minWidth:200},name:"content",value:t}))),i.a.createElement(v.a.Field,null,i.a.createElement(R.a,{icon:"code",content:"Code Preview"}),i.a.createElement(f.a,{style:{overflow:"auto",minHeight:330,maxHeight:330,maxWidth:600,minWidth:200},textAlign:"left"},l)))))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.currentTask===t.currentTask?null:{currentTask:e.currentTask,submissions:e.submissions,"assignment-name":e.currentTask["task-name"]}}}]),t}(i.a.Component),F=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={currentTask:n.props.currentTask,reviews:n.props.reviews,netId:n.props.netId,"assignment-name":n.props.currentTask["peer-review-for"],content:"",theInputKey:"",fileName:"",rubric:[],submissions:e.submissions},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){T.a.highlightAll()}},{key:"componentDidMount",value:function(){T.a.highlightAll()}},{key:"handleItemClick",value:function(e,t){this.setState({rubric:t.review.rubric,"reviewer-id":t})}},{key:"render",value:function(){var e,t=this,n=this.state.submissions.find((function(e,n,a){return e.netId===t.state.netId&&e["assignment-name"]===t.state["assignment-name"]})),a="";"undefined"!==typeof n&&(a=n.content),e=this.state.reviews.filter((function(e,n,a){return e["assignment-name"]===t.state["assignment-name"]&&e["submitter-id"]===t.state.netId})).map((function(e,n,a){return i.a.createElement(H.a.Item,{name:"Review".concat(n),as:"a",onClick:function(n){return t.handleItemClick(n,e)},key:"Review".concat(e).concat(n),active:e===t.state["reviewer-id"]},"Review".concat(n))}));var s=a,r=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:s})),c=this.state.rubric.map((function(e,t,n){var a=e.comments,s=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:a}));return i.a.createElement(P.a.Row,{key:"roww".concat(t).concat(e["rubric-name"])},i.a.createElement(P.a.Cell,{key:"rubric".concat(t).concat(e["rubric-name"])},e["rubric-name"]),i.a.createElement(P.a.Cell,{key:"possiblepts".concat(t).concat(e["rubric-name"])},e["possible-points"]),i.a.createElement(P.a.Cell,{key:"pointsGiven".concat(t).concat(e["rubric-name"])},e["points-given"]),i.a.createElement(P.a.Cell,{key:"comment".concat(t).concat(e["rubric-name"])},s))})),o=this.state.currentTask.instructions,l=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:o})),u=this.state.currentTask.rubric.map((function(e,t,n){var a=e.criteria,s=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:a}));return i.a.createElement(P.a.Row,{key:"row".concat(e["rubric-name"]).concat(t)},i.a.createElement(P.a.Cell,{key:"points".concat(e["rubric-name"]).concat(t)},e.points),i.a.createElement(P.a.Cell,{key:"rubric".concat(e["rubric-name"]).concat(t)},e["rubric-name"]),i.a.createElement(P.a.Cell,{key:"criteria".concat(e["rubric-name"]).concat(t)},s))}));return i.a.createElement(h.a,{stackable:!0},i.a.createElement(h.a.Column,null,i.a.createElement(h.a.Row,null,i.a.createElement(f.a,{style:{boxShadow:"none"}},i.a.createElement("span",null,i.a.createElement(p.a,{textAlign:"center",as:"h4"},i.a.createElement(I.a,{name:"tag"}),this.state.currentTask["peer-review-for"])))),i.a.createElement(h.a.Row,null,i.a.createElement(v.a,{centered:"true"},i.a.createElement(f.a,{textAlign:"center"},i.a.createElement(v.a.Group,{centered:"true",widths:"equal"},i.a.createElement(v.a.Field,{inline:!0},i.a.createElement(R.a,{icon:"calendar alternate",content:"Due"}),i.a.createElement(j.a,{readOnly:!0},new Date(this.state.currentTask.due).toLocaleString())),i.a.createElement(v.a.Field,{inline:!0},i.a.createElement(R.a,{icon:"lock open",content:"Status"}),i.a.createElement(j.a,{readOnly:!0,style:{color:"red"}},"Closed")))))),i.a.createElement(p.a,{textAlign:"center",as:"h4"},i.a.createElement(I.a,{name:"code"}),"View Reviews for my assignments"),i.a.createElement("span",null," ",i.a.createElement(G.a,{className:"modal1",trigger:i.a.createElement(b.a,null,"View Rubrics")},i.a.createElement(G.a.Header,null,"Rubrics"),i.a.createElement(G.a.Content,{scrolling:!0},i.a.createElement(G.a.Description,null,i.a.createElement(p.a,null,"Rubrics for ",this.state.currentTask["peer-review-for"]),i.a.createElement("div",null,"General Instructions: ",l),i.a.createElement(P.a,null,i.a.createElement(P.a.Header,null,i.a.createElement(P.a.Row,null,i.a.createElement(P.a.HeaderCell,null," Possible points"),i.a.createElement(P.a.HeaderCell,null," Rubric name"),i.a.createElement(P.a.HeaderCell,null," Criteria"))),i.a.createElement(P.a.Body,null,u)))))),i.a.createElement(h.a.Row,{columns:2},i.a.createElement(h.a,{celled:!0},i.a.createElement(h.a.Column,{width:8},i.a.createElement(H.a,{pointing:!0,secondary:!0},e),i.a.createElement("hr",null),i.a.createElement(P.a,null,i.a.createElement(P.a.Header,null,i.a.createElement(P.a.Row,null,i.a.createElement(P.a.HeaderCell,null,"Rubric name"),i.a.createElement(P.a.HeaderCell,null,"Possible pts"),i.a.createElement(P.a.HeaderCell,null,"Points given"),i.a.createElement(P.a.HeaderCell,null,"Comments"))),i.a.createElement(P.a.Body,null,c))),i.a.createElement(h.a.Column,{width:8},i.a.createElement(f.a,{style:{overflow:"auto",minHeight:330,maxHeight:330,maxWidth:500,minWidth:200},textAlign:"left"},r))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.currentTask===t.currentTask?null:{currentTask:e.currentTask,reviews:e.reviews,"assignment-name":e.currentTask["peer-review-for"],rubric:[],submissions:e.submissions,content:""}}}]),t}(i.a.Component),q=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={submissionTasks:[],reviewTasks:[],mode:"",submissions:[],studentAssignment:[],reviews:[],firstName:e.firstName,lastName:e.lastName},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("/submissionTask",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({submissionTasks:t.submissionTasks})})),fetch("/reviewTask",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({reviewTasks:t.reviewTasks})})),fetch("/submissions/",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({submissions:t.submissions})})),fetch("/reviews/",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({reviews:t.reviews})})),fetch("/studentAssignment/",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({studentAssignment:t.studentAssignment})})),T.a.highlightAll()}},{key:"handleOpenSubmissionItemClick",value:function(e,t){this.setState({mode:"submit",currentTask:t})}},{key:"handleClosedSubmissionItemClick",value:function(e,t){this.setState({mode:"submitted",currentTask:t})}},{key:"handleOpenReviewItemClick",value:function(e,t){this.setState({mode:"review",currentTask:t})}},{key:"handleClosedReviewItemClick",value:function(e,t){this.setState({mode:"reviewed",currentTask:t})}},{key:"handleViewComponent",value:function(){var e=this,t=this.state.mode;if("submit"===t)return"undefined"===typeof(new A.a).get("user")&&this.props.onlogoutClick(),i.a.createElement(x,{currentTask:this.state.currentTask,netId:this.props.netId,onclickLogout:function(){return e.props.onlogoutClick()}});if("review"===t)return"undefined"===typeof(new A.a).get("user")&&this.props.onlogoutClick(),i.a.createElement(W,{currentTask:this.state.currentTask,netId:this.props.netId,reviewTask:this.state.reviewTasks,studentAssignment:this.state.studentAssignment,submissions:this.state.submissions,reviews:this.state.reviews,onclickLogout:function(){return e.props.onlogoutClick()}});if("submitted"===t)return"undefined"===typeof(new A.a).get("user")&&this.props.onlogoutClick(),i.a.createElement(L,{currentTask:this.state.currentTask,netId:this.props.netId,reviewTask:this.state.reviewTasks,studentAssignment:this.state.studentAssignment,submissions:this.state.submissions,reviews:this.state.reviews,onclickLogout:function(){return e.props.onlogoutClick()}});if("reviewed"===t)return"undefined"===typeof(new A.a).get("user")&&this.props.onlogoutClick(),i.a.createElement(F,{currentTask:this.state.currentTask,netId:this.props.netId,reviewTask:this.state.reviewTasks,studentAssignment:this.state.studentAssignment,submissions:this.state.submissions,reviews:this.state.reviews,onclickLogout:function(){return e.props.onlogoutClick()}});var n=this.state.submissionTasks.map((function(t,n,a){var s=new Date(t.due).getTime();if((new Date).getTime()-s<0)return i.a.createElement(H.a.Item,{name:t["task-name"],key:"osstask".concat(n),onClick:function(n){return e.handleOpenSubmissionItemClick(n,t)},active:t===e.state.currentTask},i.a.createElement("span",null,i.a.createElement(I.a,{name:"tag"}),t["task-name"]))})),a=this.state.reviewTasks.map((function(t,n,a){var s=new Date(t.due).getTime();if((new Date).getTime()-s<0)return i.a.createElement(H.a.Item,{name:t["peer-review-for"],key:"ortask".concat(n),onClick:function(n){return e.handleOpenReviewItemClick(n,t)},active:t===e.state.currentTask},i.a.createElement("span",null,i.a.createElement(I.a,{name:"tag"}),t["peer-review-for"]))}));return i.a.createElement("div",null,i.a.createElement(f.a,{placeholder:!0,style:{overflow:"auto",minHeight:230,maxHeight:330,minWidth:200}},i.a.createElement(p.a,null,i.a.createElement(I.a,{name:"tasks",circular:!0,inverted:!0,color:"blue"}),i.a.createElement(p.a.Content,null,"You have the following assignments to submit")),i.a.createElement(H.a,null,n)),i.a.createElement(f.a,{placeholder:!0,style:{overflow:"auto",minHeight:230,maxHeight:330,minWidth:200}},i.a.createElement(p.a,null,i.a.createElement(I.a,{name:"tasks",circular:!0,inverted:!0,color:"blue"}),i.a.createElement(p.a.Content,null,"You have the following reviews to submit")),i.a.createElement(H.a,null,a)))}},{key:"render",value:function(){var e=this,t=this.state.submissionTasks.map((function(t,n,a){var s=new Date(t.due).getTime();if((new Date).getTime()-s<0)return i.a.createElement(H.a.Item,{name:t["task-name"],key:"ostask".concat(n),onClick:function(n){return e.handleOpenSubmissionItemClick(n,t)},active:t===e.state.currentTask},i.a.createElement("span",null,i.a.createElement(I.a,{name:"tag",color:"teal"}),t["task-name"]))})),n=this.state.submissionTasks.map((function(t,n,a){var s=new Date(t.due).getTime();if((new Date).getTime()-s>=0)return i.a.createElement(H.a.Item,{name:t["task-name"],key:"cstask".concat(n),onClick:function(n){return e.handleClosedSubmissionItemClick(n,t)},active:t===e.state.currentTask},i.a.createElement("span",null,i.a.createElement(I.a,{name:"tag",color:"teal"}),t["task-name"]))})),a=this.state.reviewTasks.map((function(t,n,a){var s=new Date(t.due).getTime();if((new Date).getTime()-s<0)return i.a.createElement(H.a.Item,{name:t["peer-review-for"],key:"ortask".concat(n),onClick:function(n){return e.handleOpenReviewItemClick(n,t)},active:t===e.state.currentTask},i.a.createElement("span",null,i.a.createElement(I.a,{name:"tag",color:"teal"}),t["peer-review-for"]))})),s=this.state.reviewTasks.map((function(t,n,a){var s=new Date(t.due).getTime();if((new Date).getTime()-s>=0)return i.a.createElement(H.a.Item,{name:t["peer-review-for"],key:"crtask".concat(n),onClick:function(n){return e.handleClosedReviewItemClick(n,t)},active:t===e.state.currentTask},i.a.createElement("span",null,i.a.createElement(I.a,{name:"tag",color:"teal"}),t["peer-review-for"]))}));return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement(D.a,{as:H.a,animation:"push",direction:"left",icon:"labeled",inverted:!0,visible:!0,vertical:!0,width:"thin"},i.a.createElement(H.a.Item,null,i.a.createElement(I.a,{name:"tasks",color:"blue"}),i.a.createElement(H.a.Header,null,"Tasks to submit"),i.a.createElement(H.a.Menu,null,t)),i.a.createElement(H.a.Item,null,i.a.createElement(I.a,{name:"tasks",color:"blue"}),i.a.createElement(H.a.Header,null,"Tasks to Review"),i.a.createElement(H.a.Menu,null,a)),i.a.createElement(H.a.Item,null,i.a.createElement(I.a,{name:"tasks",color:"red"}),i.a.createElement(H.a.Header,null,"my Submissions"),i.a.createElement(H.a.Menu,null,n)),i.a.createElement(H.a.Item,null,i.a.createElement(I.a,{name:"tasks",color:"red"}),i.a.createElement(H.a.Header,null,"View reviews for my assignments"),i.a.createElement(H.a.Menu,null,s)))),i.a.createElement(H.a,{fixed:"top",stackable:!0,inverted:!0},i.a.createElement(N.a,null,i.a.createElement(H.a.Item,{as:"h4",header:!0,position:"right",onClick:function(){return e.setState({mode:"",currentTask:""})}},i.a.createElement(I.a,{name:"home"}),"Peer Review System"),i.a.createElement(H.a.Item,{as:"a",position:"right"},"Welcome, ".concat(this.props.netId," -- ").concat(this.props.firstName,", ").concat(this.props.lastName)),i.a.createElement(H.a.Item,{as:"a",position:"right","margin-right":"150px",onClick:this.props.onlogoutClick},i.a.createElement(I.a,{name:"sign-out"}),"Logout"))),i.a.createElement("div",{style:{marginLeft:170,minWidth:550,marginTop:50}},i.a.createElement(h.a,{padded:!0,stackable:!0},i.a.createElement(h.a.Column,null,this.handleViewComponent()))))}}]),t}(i.a.Component),M=n(98),U=n(59),J=n(522),V=n(67),z=n.n(V),B=(n(171),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={createdTask:e.createdTask,type:e.type,studentAssignment:e.studentAssignment},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){if("submission"===this.state.type)return console.log(this.state.createdTask),i.a.createElement("div",{style:{marginLeft:170,minWidth:550,marginTop:50}},i.a.createElement(h.a,{padded:!0,stackable:!0},i.a.createElement(v.a,null,i.a.createElement(v.a.Field,{inline:!0},i.a.createElement(v.a.Input,{fluid:!0,label:"Task Name",content:this.state.createdTask["task-name"],readOnly:!0})))))}}]),t}(i.a.Component)),K=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChanges=function(){var e=Object(g.a)(E.a.mark((function e(t){var a,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target,i=a.value,s=a.name,n.setState(Object(c.a)({},s,i));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.assignTask=function(){var e=Object(g.a)(E.a.mark((function e(t,a){var i,s,r,c,o,l,u,m,d,h,p,v,f,b,k,w,g,y,T,C,S,R,I,j,O,A,x;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(x=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*t),a=e[t];e[t]=e[n],e[n]=a}},C=function(e,t){return e.student>t.student?1:-1},i=n.state.submissions.filter((function(e,t,a){return e["assignment-name"]===n.state.selectedReview})),s=a,r=i.length,c=[],o=0;o<r;o++)c[o]=o;for(x(c),l=[],u=0;u<r;u++)m=i[c[u]].netId,d={student:m,reviewers:new Set},l.push(d);for(h=[],p=0;p<r;p++)v=i[c[p]].netId,f={student:v,reviewees:new Set},h.push(f);b=0;case 13:if(!(b<r)){e.next=30;break}k=l[b],w=1;case 16:if(!(k.reviewers.size<s)){e.next=27;break}if(!(h[g=(b+w)%r].reviewees.size>=s)){e.next=20;break}return e.abrupt("continue",16);case 20:y=i[c[g]].netId,k.reviewers.add(y),T=i[c[b]].netId,h[g].reviewees.add(T),w++,e.next=16;break;case 27:b++,e.next=13;break;case 30:for(l.sort(C),h.sort(C),S=[],R=0;R<r;R++)I=Array.from(l[R].reviewers),j=Array.from(h[R].reviewees),S.push({student:l[R].student,reviewers:I,reviewees:j});O={"peer-review-for":n.state.selectedReview,studentsAssignment:S},A=Object(U.a)(n),fetch("/studentAssignment/"+n.state.selectedReview,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(O)}).then((function(e){A.setState({newAssignments:S,reviews:h})}));case 37:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n.state={submissionTasks:n.props.submissionTasks,reviewTasks:n.props.reviewTasks,selectedType:"submission",instructions:"",selectedReview:"",dueDate:new Date,rubricIds:[1],rubric:[],submissions:n.props.submissions,newAssignments:[],reviews:[],num:0,studentAssignment:[],isSubmitted:!1},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){T.a.highlightAll()}},{key:"componentDidMount",value:function(){T.a.highlightAll()}},{key:"handleChange",value:function(e,t){this.setState(Object(c.a)({},t.name,t.value))}},{key:"handleRubricChange",value:function(e,t,n){var a=this;this.handleChanges(e).then((function(){var e={"rubric-name":a.state["rubric".concat(t)],points:a.state["point".concat(t)],criteria:a.state["criteria".concat(t)]};a.state.rubric.splice(n,1,e),a.setState({rubric:a.state.rubric})}))}},{key:"handleSubmit",value:function(e,t){var n=this;if("undefined"===typeof(new A.a).get("user"))alert("session expired"),this.props.onclickLogout();else{var a=this;if("submission"===this.state.selectedType){var i={type:this.state.selectedType,"task-name":this.state.selectedReview,due:this.state.dueDate.toISOString()};"undefined"===typeof this.state.submissionTasks.find((function(e,t,a){return e["task-name"]===n.state.selectedReview}))?fetch("/submissionTask",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(i)}).then((function(e){a.state.submissionTasks.push(i),a.setState({selectedType:"submission",instructions:"",selectedReview:"",dueDate:new Date,submissionTasks:a.state.submissionTasks,currentTask:i}),a.props.update(),alert("submission task created successfully"),a.props.viewHome()})):(alert("Submission task already exists"),this.setState({selectedReview:""}))}else{var s=this.state.submissions.filter((function(e,t,a){return e["assignment-name"]===n.state.selectedReview}));parseInt(this.state.num)<=s.length&&parseInt(this.state.num)>0?this.assignTask(e,t).then((function(){var e={"peer-review-for":n.state.selectedReview,due:n.state.dueDate.toISOString(),rubric:n.state.rubric,instructions:n.state.instructions},t={"peer-review-for":n.state.selectedReview,studentsAssignment:n.state.newAssignments};fetch("/reviewTask",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(e)}).then((function(n){a.state.reviewTasks.push(e),a.state.studentAssignment.push(t),a.setState({selectedType:"review",instructions:"",dueDate:new Date,num:0,reviewTasks:a.state.reviewTasks,studentAssignment:a.state.studentAssignment,currentTask:e}),alert("review task created successfully"),a.props.viewHome()}))})):alert("Number of reviews is not valid")}}}},{key:"addRubrics",value:function(e){var t=this.state.rubricIds[this.state.rubricIds.length-1];this.setState({rubricCount:this.state.rubricIds.push(t+1)})}},{key:"deleteRubrics",value:function(e,t,n){this.state.rubric.splice(n,1);var a,i=this.state.rubricIds.indexOf(t);(this.state.rubricIds.splice(i,1),i>-1)&&this.setState((a={},Object(c.a)(a,"point".concat(t),void 0),Object(c.a)(a,"rubric".concat(t),void 0),Object(c.a)(a,"criteria".concat(t),void 0),Object(c.a)(a,"rubric",this.state.rubric),Object(c.a)(a,"rubricIds",this.state.rubricIds),a))}},{key:"displayRubrics",value:function(){var e=this;return this.state.rubricIds.map((function(t,n,a){return i.a.createElement(v.a.Group,{key:"group".concat(n)},i.a.createElement(R.a,{content:"Rubric"}),i.a.createElement(v.a.Input,{name:"point".concat(t),type:"number",label:"Points",placeholder:"Points",width:6,onChange:function(a){return e.handleRubricChange(a,t,n)},key:"point".concat(t),required:!0,min:"1",value:e.state["point".concat(t)]||""}),i.a.createElement(v.a.Input,{name:"rubric".concat(t),label:"rubric-name",placeholder:"rubric-name",required:!0,width:8,key:"rubric".concat(t),onChange:function(a){return e.handleRubricChange(a,t,n)},value:e.state["rubric".concat(t)]||""}),i.a.createElement(v.a.TextArea,{name:"criteria".concat(t),label:"criteria",placeholder:"criteria",width:12,required:!0,key:"criteria".concat(t),onChange:function(a){return e.handleRubricChange(a,t,n)},value:e.state["criteria".concat(t)]||""}),i.a.createElement(b.a,{basic:!0,icon:!0,size:"mini",circular:!0,onClick:function(t){return e.addRubrics(t)},disabled:!e.state["point".concat(t)]||!e.state["rubric".concat(t)]||!e.state["criteria".concat(t)]},i.a.createElement(I.a,{name:"add"})),i.a.createElement(b.a,{basic:!0,icon:!0,size:"mini",circular:!0,onClick:function(a){return e.deleteRubrics(a,t,n)},disabled:1===e.state.rubricIds.length},i.a.createElement(I.a,{name:"delete"})))}))}},{key:"display",value:function(){if(this.state.newAssignments.length>0)return this.displayAssignments()}},{key:"displayAssignments",value:function(){var e=this.state.newAssignments.map((function(e,t,n){return i.a.createElement(P.a.Row,{key:"row".concat(t)},i.a.createElement(P.a.Cell,{key:"cell".concat(t)},i.a.createElement(j.a,{transparent:!0,key:"AssignmentValue".concat(t),name:"AssignmentValue".concat(t)},e.student)),function(e){return e.reviewers.map((function(e,t,n){return i.a.createElement(P.a.Cell,{key:"cell2".concat(t)},e)}))}(e))}));return i.a.createElement(G.a,{trigger:i.a.createElement(b.a,null,"View assignments")},i.a.createElement(G.a.Header,null,"Rubrics"),i.a.createElement(G.a.Content,{scrolling:!0},i.a.createElement(G.a.Description,null,i.a.createElement(p.a,null,"Modal Header"),i.a.createElement(P.a,{celled:!0},i.a.createElement(P.a.Header,null,i.a.createElement(P.a.Row,null,i.a.createElement(P.a.HeaderCell,null,"Submitter Id"),i.a.createElement(P.a.HeaderCell,{colSpan:this.state.num},"Reviewed by"))),i.a.createElement(P.a.Body,null,e)))))}},{key:"render",value:function(){var e=this,t=[],n=this.state.submissionTasks.filter((function(e){var t=new Date(e.due).getTime();if((new Date).getTime()-t>=0)return e}));if(n.length>0){for(var a=n.length,s=0;s<this.state.reviewTasks.length;s++)for(var r=0;r<a;r++)n[r]["task-name"]===this.state.reviewTasks[s]["peer-review-for"]&&(n.splice(r,1),a=n.length);n.map((function(e,n,a){t.push({key:"hw".concat(n).concat(e["task-name"]),text:e["task-name"],value:e["task-name"]})}))}var c=this.state.submissions.filter((function(t,n,a){return t["assignment-name"]===e.state.selectedReview})),o=this.state.selectedType;return!0===this.state.isSubmitted?i.a.createElement(B,{createdTask:this.state.currentTask,type:this.state.selectedType,studentAssignment:this.state.studentAssignment}):i.a.createElement("div",null,i.a.createElement("div",{style:{marginLeft:10,marginRight:10,minWidth:550,marginTop:50}},i.a.createElement(h.a,{stackable:!0},i.a.createElement(h.a.Column,null,i.a.createElement(h.a.Row,null,i.a.createElement(f.a,{style:{boxShadow:"none"},textAlign:"center"},i.a.createElement(p.a,{textAlign:"center",as:"h4"},i.a.createElement(I.a,{name:"tag"}),"Create Task"))),i.a.createElement(h.a.Row,{textAlign:"center"},i.a.createElement(f.a,{align:"center"},i.a.createElement(v.a,{align:"center"},i.a.createElement(v.a.Field,{inline:!0,required:!0},i.a.createElement("label",null,"Task Type"),i.a.createElement(J.a,{placeholder:"task type",value:this.state.selectedType,name:"selectedType",options:[{key:"submission",text:"Submission",value:"submission"},{key:"review",text:"Review",value:"review"}],onChange:function(t,n){return e.handleChange(t,n)}})),"review"===o?i.a.createElement("div",null,i.a.createElement(v.a.Field,{inline:!0,required:!0},i.a.createElement("label",null,"Task name"),i.a.createElement(J.a,{placeholder:"Select the task name",name:"selectedReview",value:this.state.selectedReview,options:t,onChange:function(t,n){return e.handleChange(t,n)}})),i.a.createElement(v.a.Field,{inline:!0,required:!0},i.a.createElement("label",null,"Due"),i.a.createElement(z.a,{selected:this.state.dueDate,onChange:function(t){return e.setState({dueDate:t})},showTimeSelect:!0,timeFormat:"p",timeIntervals:15,dateFormat:"Pp"})),i.a.createElement(v.a.Field,{inline:!0,required:!0},i.a.createElement("label",null,"General Instructions"),i.a.createElement(O.a,{style:{minHeight:100,minWidth:200,maxHeight:100,maxWidth:300},placeholder:"markdown instructions",name:"instructions",value:this.state.instructions,onChange:function(t){e.handleChanges(t)}})),i.a.createElement(h.a,{textAlign:"center"},i.a.createElement(h.a.Column,{width:10},this.displayRubrics())),i.a.createElement(v.a.Field,{inline:!0,required:!0},i.a.createElement("label",null,"Enter number of reviews"),i.a.createElement(j.a,{name:"num",type:"number",label:"num",placeholder:"num",width:4,onChange:function(t){return e.handleChanges(t)},min:0,max:c.length,value:this.state.num})),this.display(),i.a.createElement("span",null,i.a.createElement(b.a,{type:"submit",onClick:function(t){return e.handleSubmit(t,e.state.num)},disabled:!this.state.selectedReview||!this.state.instructions||!this.state.rubric||this.state.num<=0},"Submit"))):i.a.createElement("div",null,i.a.createElement(v.a.Field,{inline:!0,required:!0},i.a.createElement("label",null,"Task name"),i.a.createElement(j.a,{placeholder:"Eg: HW3",name:"selectedReview",value:this.state.selectedReview,onChange:function(t){return e.handleChanges(t)}})),i.a.createElement(v.a.Field,{inline:!0,required:!0},i.a.createElement("label",null,"Due"),i.a.createElement(z.a,{selected:this.state.dueDate,onChange:function(t){return e.setState({dueDate:t})},showTimeSelect:!0,timeFormat:"p",timeIntervals:15,dateFormat:"Pp"})),i.a.createElement("span",null,i.a.createElement(b.a,{type:"submit",onClick:function(t){return e.handleSubmit(t)},disabled:!this.state.selectedReview},"Submit"))))))))))}}]),t}(i.a.Component),Y=n(525),_=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleCancel=function(){console.log("fffffff"),n.setState({open:!1})},n.handleConfirm=function(){console.log("deeeeeeee");var e=Object(U.a)(n),t=e.state.submissionTasks.findIndex((function(e,t,a){return e["task-name"]===n.state["task-name"]}));fetch("/submissionTask/"+n.state.currentSTask["task-name"],{method:"DELETE",headers:{"Content-type":"application/json"}}).then((function(){fetch("/submissions/"+n.state.currentSTask["task-name"],{method:"DELETE",headers:{"Content-type":"application/json"}}).then((function(n){alert("Task has been deleted"),e.state.submissionTasks.splice(t,1),e.state.specificSubmissions=[],e.setState({isDeleted:!0,submissionTasks:e.state.submissionTasks,specificSubmissions:e.state.specificSubmissions,open:!1}),e.props.viewHome()}))}))},n.state={specificSubmissions:e.specificSubmissions,currentSTask:e.currentSTask,content:"Click on a student ID to view their submission","task-name":e.currentSTask["task-name"],open:!1,isDeleted:!1,due:new Date(e.currentSTask.due),mode:e.mode,isEdited:!1,submittedOn:"",submissionTasks:e.submissionTasks},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(){T.a.highlightAll()}},{key:"componentDidMount",value:function(){T.a.highlightAll()}},{key:"handleClick",value:function(e,t){this.setState({content:t.content,"student-id":t.netId,submittedOn:t.submittedOn})}},{key:"viewContent",value:function(){var e=this,t=this.state.content,n=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:t}));return i.a.createElement(f.a,{style:{overflow:"auto",minHeight:500,maxHeight:330,maxWidth:1e3,minWidth:200}},i.a.createElement(b.a,{onClick:function(t){return e.handleDeleteSubmission(t)},color:"red",disabled:"Click on a student ID to view their submission"===this.state.content},"Delete submission"),i.a.createElement(R.a,null,"Submitted on:",new Date(this.state.submittedOn).toLocaleString()),n)}},{key:"handleDeleteSubmission",value:function(e){var t=this,n=new A.a;n.get("user");if("undefined"===typeof n.get("user"))alert("session expired"),this.props.onclickLogout();else{var a=this.state.specificSubmissions.findIndex((function(e,n,a){return e.netId===t.state["student-id"]})),i=this;fetch("/submissions/"+this.state.currentSTask["task-name"]+"/student/"+this.state["student-id"],{method:"DELETE",headers:{"Content-type":"application/json"}}).then((function(e){i.state.specificSubmissions.splice(a,1),i.setState({specificSubmissions:i.state.specificSubmissions,content:""}),i.props.update()}))}}},{key:"handleEditTask",value:function(e){var t=this,n=new A.a;n.get("user");if("undefined"===typeof n.get("user"))alert("session expired"),this.props.onclickLogout();else{var a=this.state.submissionTasks.findIndex((function(e,n,a){return e["task-name"]===t.state["task-name"]})),i=this,s={type:"submission","task-name":this.state["task-name"],due:this.state.due.toISOString()};fetch("/submissionTask/"+this.state.currentSTask["task-name"],{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(s)}).then((function(e){alert("Task has been edited"),i.state.submissionTasks.splice(a,1,s),i.setState({isEdited:!0,submissionTasks:i.state.submissionTasks}),i.props.update()}))}}},{key:"handleDeleteTask",value:function(){"undefined"===typeof(new A.a).get("user")?(alert("session expired"),this.props.onclickLogout()):this.setState({open:!0})}},{key:"render",value:function(){var e=this,t=this.state.specificSubmissions.map((function(t,n,a){return i.a.createElement(P.a.Row,{key:"row".concat(t.netId)},i.a.createElement(P.a.Cell,{key:"submission".concat(t.netId),onClick:function(n){return e.handleClick(n,t)},active:e.state["student-id"]===t.netId},t.netId))}));return i.a.createElement(h.a,{stackable:!0},i.a.createElement(h.a.Column,null,i.a.createElement(h.a.Row,null,i.a.createElement(f.a,{style:{boxShadow:"none"}},i.a.createElement("span",null,i.a.createElement(p.a,{textAlign:"center",as:"h4"},i.a.createElement(j.a,{label:"Submission Task-name",size:"small",icon:"tag",name:"task-name",value:this.state["task-name"],readOnly:!0,onChange:function(t){return e.setState({"task-name":t.target.value})}}))))),i.a.createElement(h.a.Row,null,i.a.createElement(h.a.Column,null,i.a.createElement(v.a,{centered:"true"},i.a.createElement(f.a,{textAlign:"center"},i.a.createElement(v.a.Group,{centered:"true",widths:"equal"},i.a.createElement(v.a.Field,{inline:!0,required:!0},i.a.createElement(R.a,{icon:"calendar alternate",content:"Due"}),i.a.createElement(z.a,{selected:this.state.due,onChange:function(t){return e.setState({due:t})},showTimeSelect:!0,timeFormat:"p",timeIntervals:15,dateFormat:"Pp"})),i.a.createElement(b.a,{onClick:function(t){return e.handleEditTask(t)}},"Save task details!"),i.a.createElement(b.a,{onClick:function(t){return e.handleDeleteTask(t)}}," Delete task"),i.a.createElement(Y.a,{open:this.state.open,onCancel:this.handleCancel,onConfirm:this.handleConfirm})))))),i.a.createElement(h.a.Row,null,i.a.createElement(h.a,null,i.a.createElement(h.a.Row,null,i.a.createElement(h.a.Column,{width:4},i.a.createElement(P.a,{color:"blue"},i.a.createElement(P.a.Header,null,i.a.createElement(P.a.Row,null,i.a.createElement(P.a.HeaderCell,null,"Student Ids submitted"))),i.a.createElement(P.a.Body,null,t))),i.a.createElement(h.a.Column,{width:12},this.viewContent()))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.currentSTask===t.currentSTask?null:{currentSTask:e.currentSTask,specificSubmissions:e.specificSubmissions,content:"Click on a student ID to view their submission","task-name":e.currentSTask["task-name"],due:new Date(e.currentSTask.due)}}}]),t}(i.a.Component),Q=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleEachChange=function(){var e=Object(g.a)(E.a.mark((function e(t,a,i){var s,r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=t.target,r=s.value,o=s.name,n.setState(Object(c.a)({},o,r));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),n.handleCancel=function(){n.setState({open:!1})},n.handleConfirm=function(){if("undefined"===typeof(new A.a).get("user"))alert("session expired"),n.props.onclickLogout();else{var e=Object(U.a)(e),t=e.state.reviewTasks.findIndex((function(t,n,a){return t["peer-review-for"]===e.state["peer-review-for"]}));fetch("/ReviewTask/"+e.state.currentRTask["peer-review-for"],{method:"DELETE",headers:{"Content-type":"application/json"}}).then((function(t){e.setState({open:!1}),e.props.update()})).then((function(){fetch("/reviews/"+e.state.currentRTask["peer-review-for"],{method:"DELETE",headers:{"Content-type":"application/json"}}).then((function(){fetch("/studentAssignment/"+e.state.currentRTask["peer-review-for"],{method:"DELETE",headers:{"Content-type":"application/json"}}).then((function(n){alert("Task has been deleted"),e.state.reviewTasks.splice(t,1),e.state.specAssignments.studentsAssignment=[],e.state.specificReviews=[],e.setState({isDeleted:!0,reviewTasks:e.state.reviewTasks,specAssignments:e.state.specAssignments,specificReviews:e.state.specificReviews}),e.props.viewHome()}))}))}))}},n.state={specificReviews:e.specificReviews,currentRTask:e.currentRTask,content:"",specSubmissions:e.specSubmissions,reviewDetails:[],reviewRubric:[],"peer-review-for":e.currentRTask["peer-review-for"],due:new Date(e.currentRTask.due),specAssignments:e.specAssignments,teacherRubrics:e.currentRTask.rubric,open:!1,reviewTasks:e.reviewTasks,isDeleted:!1,isEdited:!1,isTaskEdited:!1,isSaved:!1,instructions:e.currentRTask.instructions},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){var n=this;if(t["peer-review-for"]!==this.state["peer-review-for"])this.state.currentRTask.rubric.map((function(e,t,a){var i;n.setState((i={},Object(c.a)(i,"point".concat(t),e.points),Object(c.a)(i,"rubric".concat(t),e["rubric-name"]),Object(c.a)(i,"criteria".concat(t),e.criteria),i))})),this.state.specificReviews.map((function(e,t,a){e.review.rubric.map((function(t,a,i){var s;n.setState((s={},Object(c.a)(s,"inputPoint".concat(t["rubric-name"]).concat(e["submitter-id"]).concat(e["reviewer-id"]),t["points-given"]),Object(c.a)(s,"inputComment".concat(t["rubric-name"]).concat(e["submitter-id"]).concat(e["reviewer-id"]),t.comments),s))}))}));T.a.highlightAll()}},{key:"componentDidMount",value:function(){var e=this;this.state.currentRTask.rubric.map((function(t,n,a){var i;e.setState((i={},Object(c.a)(i,"point".concat(n),t.points),Object(c.a)(i,"rubric".concat(n),t["rubric-name"]),Object(c.a)(i,"criteria".concat(n),t.criteria),i))})),this.state.specificReviews.map((function(t,n,a){t.review.rubric.map((function(n,a,i){var s;e.setState((s={},Object(c.a)(s,"inputPoint".concat(n["rubric-name"]).concat(t["submitter-id"]).concat(t["reviewer-id"]),n["points-given"]),Object(c.a)(s,"inputComment".concat(n["rubric-name"]).concat(t["submitter-id"]).concat(t["reviewer-id"]),n.comments),s))}))}));T.a.highlightAll()}},{key:"viewPoints",value:function(e){return this.state.specificReviews.filter((function(t,n,a){return t["submitter-id"]===e})).map((function(e,t,n){return e.review["total-points"]<10?i.a.createElement(P.a.Cell,{negative:!0,key:"review".concat(e["reviewer-id"])},e.review["total-points"]):i.a.createElement(P.a.Cell,{key:"review".concat(e["reviewer-id"])},e.review["total-points"])}))}},{key:"handleItemClick",value:function(e,t){var n="",a=this.state.specSubmissions.find((function(e,n,a){return e.netId===t}));"undefined"!=typeof a&&(n=a.content);var i=this.state.specificReviews.filter((function(e,n,a){return e["submitter-id"]===t}));this.setState({content:n,reviewDetails:i,"student-id":t,viewReviews:!1,"reviewer-id":""})}},{key:"viewContents",value:function(){var e=this.state.content,t=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:e}));return i.a.createElement(f.a,{style:{overflow:"auto",minHeight:500,maxHeight:330,maxWidth:1e3,minWidth:150}},t)}},{key:"handleReviewClick",value:function(e,t){this.setState({reviewRubric:t.review.rubric,"reviewer-id":t["reviewer-id"],viewReviews:!0})}},{key:"addRubrics",value:function(e){this.state.teacherRubrics.push({points:"","rubric-name":"",criteria:""}),this.setState({teacherRubrics:this.state.teacherRubrics})}},{key:"handleEditReviews",value:function(e){this.setState({isEdited:!0})}},{key:"handleEditTaskDetails",value:function(e){this.setState({isTaskEdited:!0})}},{key:"handleRubricChange",value:function(e,t,n){var a=this;this.handleEachChange(e).then((function(){var e={"rubric-name":a.state["rubric".concat(n)],points:a.state["point".concat(n)],criteria:a.state["criteria".concat(n)]};a.state.teacherRubrics.splice(n,1,e),a.setState({teacherRubrics:a.state.teacherRubrics})}))}},{key:"handleEditTask",value:function(e){var t=this,n=new A.a;n.get("user");if("undefined"===typeof n.get("user"))alert("session expired"),this.props.onclickLogout();else{var a=this.state.reviewTasks.findIndex((function(e,n,a){return e["peer-review-for"]===t.state["peer-review-for"]})),i=this,s={"peer-review-for":this.state["peer-review-for"],due:this.state.due.toISOString(),rubric:this.state.teacherRubrics,instructions:this.state.instructions},r=this.state.specAssignments;fetch("/reviewTask/"+this.state.currentRTask["peer-review-for"],{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(s)}).then((function(){fetch("/studentAssignment/"+t.state.currentRTask["task-name"],{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(r)}).then((function(e){i.props.update()}))})).then((function(e){i.state.reviewTasks.splice(a,1,s),i.setState({isTaskEdited:!1,reviewTasks:i.state.reviewTasks})}))}}},{key:"handleEditOneReview",value:function(e,t,n){var a=this;this.handleEachChange(e).then((function(){var e={"rubric-name":t["rubric-name"],"possible-points":t["possible-points"],"points-given":a.state["inputPoint".concat(t["rubric-name"]).concat(a.state["student-id"]).concat(a.state["reviewer-id"])],comments:a.state["inputComment".concat(t["rubric-name"]).concat(a.state["student-id"]).concat(a.state["reviewer-id"])]};a.state.reviewRubric.splice(n,1,e),a.setState({reviewRubric:a.state.reviewRubric})}))}},{key:"handleSaveReviews",value:function(e){var t=this;if("undefined"===typeof(new A.a).get("user"))alert("session expired"),this.props.onclickLogout();else{for(var n=0,a=0;a<this.state.reviewRubric.length;a++)n+=parseInt(this.state.reviewRubric[a]["points-given"]);var i=this.state.specificReviews.findIndex((function(e){return e["reviewer-id"]===t.state["reviewer-id"]&&e["submitter-id"]===t.state["student-id"]})),s=this,r={"assignment-name":this.state["peer-review-for"],"reviewer-id":this.state["reviewer-id"],"submitter-id":this.state["student-id"],review:{"total-points":n,"general-comments":"",rubric:this.state.reviewRubric}};fetch("/reviews/"+this.state["peer-review-for"]+"/reviewer/"+this.state["reviewer-id"]+"/submitter/"+this.state["student-id"],{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(r)}).then((function(e){s.state.specificReviews.splice(i,1,r),s.setState({specificReviews:s.state.specificReviews,isEdited:!1})}))}}},{key:"handleDeleteTask",value:function(){this.setState({open:!0})}},{key:"displayRubrics",value:function(){var e=this;return this.state.teacherRubrics.map((function(t,n,a){var s=e.state["criteria".concat(n)],r=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:s}));return i.a.createElement("div",{key:"divvv".concat(n)},e.state.isTaskEdited?i.a.createElement(v.a.Group,{key:"group".concat(n)},i.a.createElement(R.a,{content:"Rubric"}),i.a.createElement(v.a.Input,{name:"rubric".concat(n),label:"rubric-name",placeholder:"rubric-name",width:8,disabled:e.state.specificReviews.length>0,key:"rubric".concat(n),required:!0,onChange:function(a){return e.handleRubricChange(a,t,n)},value:e.state["rubric".concat(n)]}),i.a.createElement(v.a.Input,{name:"point".concat(n),type:"number",label:"Points",placeholder:"Points",width:6,onChange:function(a){return e.handleRubricChange(a,t,n)},disabled:e.state.specificReviews.length>0||""===e.state["rubric".concat(n)],key:"point".concat(n),required:!0,value:e.state["point".concat(n)]}),i.a.createElement(v.a.TextArea,{name:"criteria".concat(n),label:"criteria",placeholder:"criteria",width:12,disabled:e.state.specificReviews.length>0||""===e.state["rubric".concat(n)],required:!0,key:"criteria".concat(n),onChange:function(a){return e.handleRubricChange(a,t,n)},value:e.state["criteria".concat(n)]}),i.a.createElement(b.a,{basic:!0,icon:!0,size:"mini",circular:!0,onClick:function(t){return e.addRubrics(t)},disabled:!e.state["point".concat(n)]||!e.state["rubric".concat(n)]||!e.state["criteria".concat(n)]},i.a.createElement(I.a,{name:"add"}))):i.a.createElement(v.a.Group,{key:"group".concat(n)},i.a.createElement(R.a,{content:"Rubric"}),i.a.createElement(v.a.Input,{key:"rubric".concat(n),label:"rubric-name",width:4,readOnly:!0,value:e.state["rubric".concat(n)]||""}),i.a.createElement(v.a.Input,{key:"point".concat(n),label:"Points",width:3,readOnly:!0,value:e.state["point".concat(n)]||""}),i.a.createElement(f.a,{style:{overflow:"auto",minHeight:100,maxHeight:100,maxWidth:250,minWidth:250},textAlign:"left"},r)))}))}},{key:"displayAssignments",value:function(){var e=this.state.specAssignments.studentsAssignment.map((function(e,t,n){return i.a.createElement(P.a.Row,{key:"row".concat(t)},i.a.createElement(P.a.Cell,{key:"cell".concat(t)},e.student),function(e){return e.reviewers.map((function(e,t,n){return i.a.createElement(P.a.Cell,{key:"cell2".concat(t)},e)}))}(e))}));return i.a.createElement(G.a,{trigger:i.a.createElement(b.a,null,"View assignments")},i.a.createElement(G.a.Header,null,"Rubrics"),i.a.createElement(G.a.Content,{scrolling:!0},i.a.createElement(G.a.Description,null,i.a.createElement(p.a,null,"Modal Header"),i.a.createElement(P.a,{color:"blue",celled:!0},i.a.createElement(P.a.Header,null,i.a.createElement(P.a.Row,null,i.a.createElement(P.a.HeaderCell,null,"Submitter Id"),i.a.createElement(P.a.HeaderCell,{colSpan:this.state.num},"Reviewed by"))),i.a.createElement(P.a.Body,null,e)))))}},{key:"render",value:function(){for(var e=this,t=!0,n=this.state.reviewRubric.length,a=0;a<this.state.reviewRubric.length;a++)""!==this.state.reviewRubric[a]["points-given"]&&""!==this.state.reviewRubric[a].comments||(n-=1);n!==this.state.reviewRubric.length&&(t=!1);var s=new Set,r=(this.state.specificReviews.map((function(e,t,n){s.add(e["submitter-id"])})),Array.from(s).map((function(t,n,a){return i.a.createElement(P.a.Row,{key:"row".concat(t)},i.a.createElement(P.a.Cell,{key:"submission".concat(t),onClick:function(n){return e.handleItemClick(n,t)},active:e.state["student-id"]===t},t),e.viewPoints(t))}))),c=this.state.reviewDetails.map((function(t,n,a){return i.a.createElement(H.a.Item,{name:"ReviewDisplay".concat(n),as:"a",onClick:function(n){return e.handleReviewClick(n,t)},active:t["reviewer-id"]===e.state["reviewer-id"],key:"ReviewDisplay".concat(t).concat(n)},t["reviewer-id"])})),o=this.state.instructions,l=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:o})),u=this.state.reviewRubric.map((function(t,n,a){var s=t.comments,r=i.a.createElement("div",{id:"rawHtml",className:"language-html"},i.a.createElement(S.a,{source:s}));return i.a.createElement(P.a.Row,{key:"roww".concat(n).concat(t["rubric-name"])},i.a.createElement(P.a.Cell,{key:"rubric".concat(n).concat(t["rubric-name"])},t["rubric-name"]),i.a.createElement(P.a.Cell,{key:"possiblepts".concat(n).concat(t["rubric-name"])},t["possible-points"]),i.a.createElement(P.a.Cell,{key:"pointsGiven".concat(n).concat(t["rubric-name"])},e.state.isEdited?i.a.createElement("input",{type:"number",style:{width:"4em"},name:"inputPoint".concat(t["rubric-name"]).concat(e.state["student-id"]).concat(e.state["reviewer-id"]),required:!0,onChange:function(a){return e.handleEditOneReview(a,t,n)},key:"inputPoint".concat(t["rubric-name"]).concat(e.state["student-id"]).concat(e.state["reviewer-id"]),value:t["points-given"]||e.state["inputPoint".concat(t["rubric-name"]).concat(e.state["student-id"]).concat(e.state["reviewer-id"])]}):t["points-given"]),i.a.createElement(P.a.Cell,{key:"comment".concat(n).concat(t["rubric-name"])},e.state.isEdited?i.a.createElement(j.a,{key:"inputComment".concat(t["rubric-name"]).concat(e.state["student-id"]).concat(e.state["reviewer-id"]),name:"inputComment".concat(t["rubric-name"]).concat(e.state["student-id"]).concat(e.state["reviewer-id"]),onChange:function(a){return e.handleEditOneReview(a,t,n)},required:!0,value:s||e.state["inputComment".concat(t["rubric-name"]).concat(e.state["student-id"]).concat(e.state["reviewer-id"])]}):r))}));return i.a.createElement("div",{style:{marginLeft:10,marginRight:10,minWidth:550,marginTop:50}},i.a.createElement(h.a,{stackable:!0},i.a.createElement(h.a.Column,null,i.a.createElement(h.a.Row,null,i.a.createElement(f.a,{style:{boxShadow:"none"}},i.a.createElement("span",null,i.a.createElement(p.a,{textAlign:"center",as:"h5"},this.state.isTaskEdited?i.a.createElement(j.a,{label:"peer-review-for",icon:"tag",name:"peer-review-for",value:this.state["peer-review-for"],readOnly:!0,onChange:function(t){return e.setState({"peer-review-for":t.target.value})}}):i.a.createElement(j.a,{label:"peer-review-for",value:this.state["peer-review-for"],icon:"tag",readOnly:!0}))))),i.a.createElement(h.a.Row,{textAlign:"center"},i.a.createElement(f.a,{textAlign:"center"},i.a.createElement(v.a,{centered:"true"},i.a.createElement(v.a.Field,{inline:!0,required:!0},i.a.createElement(R.a,{icon:"calendar alternate",content:"Due"}),this.state.isTaskEdited?i.a.createElement(z.a,{selected:this.state.due,onChange:function(t){return e.setState({due:t})},showTimeSelect:!0,timeFormat:"p",timeIntervals:15,dateFormat:"Pp"}):new Date(this.state.due).toLocaleString()),i.a.createElement(v.a.Field,{inline:!0,required:!0},i.a.createElement(R.a,null,"General Instructions"),this.state.isTaskEdited?i.a.createElement(O.a,{style:{minHeight:100,minWidth:200,maxHeight:100,maxWidth:300},name:"instructions",required:!0,value:this.state.instructions,onChange:function(t){e.handleEachChange(t)}}):i.a.createElement(f.a,{style:{overflow:"auto",marginLeft:"25em",minHeight:300,maxHeight:300,maxWidth:600,minWidth:200},textAlign:"left"},l)),i.a.createElement(h.a,{textAlign:"center"},i.a.createElement(h.a.Column,{width:8},this.displayRubrics())),i.a.createElement(b.a,{onClick:function(t){return e.handleEditTaskDetails(t)},color:"blue",disabled:this.state.isTaskEdited},"Edit this task"),i.a.createElement(b.a,{onClick:function(t){return e.handleEditTask(t)},color:"teal",disabled:!this.state.isTaskEdited},"Save task details!"),i.a.createElement(b.a,{onClick:function(t){return e.handleDeleteTask(t)},color:"red"}," Delete task"),this.displayAssignments(),i.a.createElement(Y.a,{open:this.state.open,onCancel:this.handleCancel,onConfirm:this.handleConfirm})))),i.a.createElement(h.a.Row,null,i.a.createElement(h.a,null,i.a.createElement(h.a.Row,null,i.a.createElement(h.a.Column,{width:5},this.viewContents()),i.a.createElement(h.a.Column,{width:6},i.a.createElement(P.a,{color:"teal"},i.a.createElement(P.a.Header,null,i.a.createElement(P.a.Row,null,i.a.createElement(P.a.HeaderCell,null,"Student Ids submitted"),i.a.createElement(P.a.HeaderCell,{colSpan:3},"Review total points"))),i.a.createElement(P.a.Body,null,r))),i.a.createElement(h.a.Column,{width:4},i.a.createElement(f.a,{style:{overflow:"auto",minHeight:300,maxHeight:400,maxWidth:3e3,minWidth:400}},i.a.createElement(H.a,{pointing:!0,secondary:!0},c),!0===this.state.viewReviews?i.a.createElement("div",null,i.a.createElement(P.a,{color:"blue"},i.a.createElement(P.a.Header,null,i.a.createElement(P.a.Row,null,i.a.createElement(P.a.HeaderCell,null,"Rubric name"),i.a.createElement(P.a.HeaderCell,null,"Possible pts"),i.a.createElement(P.a.HeaderCell,null,"Points given"),i.a.createElement(P.a.HeaderCell,null,"Comments"))),i.a.createElement(P.a.Body,null,u)),i.a.createElement("span",null,i.a.createElement(b.a,{onClick:function(t){return e.handleEditReviews(t)},color:"blue",disabled:this.state.isEdited},"Edit review")," "),i.a.createElement("span",null,i.a.createElement(b.a,{onClick:function(t){return e.handleSaveReviews(t)},color:"teal",disabled:!this.state.isEdited||!t},"Save review")," ")):i.a.createElement("div",null,"Click on a Reviewer id")))))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.currentRTask===t.currentRTask?null:{specificReviews:e.specificReviews,currentRTask:e.currentRTask,specSubmissions:e.specSubmissions,"peer-review-for":e.currentRTask["peer-review-for"],due:new Date(e.currentRTask.due),specAssignments:e.specAssignments,teacherRubrics:e.currentRTask.rubric,reviewTasks:e.reviewTasks,instructions:e.currentRTask.instructions}}}]),t}(i.a.Component),X=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(u.a)(this,Object(m.a)(t).call(this,e)))._isMounted=!1,n.state={submissionTasks:[],reviewTasks:[],mode:"",submissions:[],reviews:[],specificSubmissions:[],currentSubmissionTask:"",specificReviews:[],currentReviewTask:"",studentAssignment:[],specAssignments:[]},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){if(t.specificSubmissions!==this.state.specificSubmissions){var n=this;fetch("/submissions/",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){n.setState({submissions:e.submissions})}))}else if(t.specificReviews!==this.state.specificReviews){var a=this;fetch("/reviews/",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){fetch("/studentAssignment/",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(e){a.setState({studentAssignment:e.studentAssignment})})),a.setState({reviews:e.reviews})}))}T.a.highlightAll()}},{key:"componentDidMount",value:function(){this._isMounted=!0;var e=this;fetch("/submissionTask",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({submissionTasks:t.submissionTasks})})),fetch("/submissions/",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({submissions:t.submissions})})),fetch("/reviewTask",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({reviewTasks:t.reviewTasks})})),fetch("/reviews/",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({reviews:t.reviews})})),fetch("/studentAssignment/",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({studentAssignment:t.studentAssignment})})),T.a.highlightAll()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"updateArray",value:function(){this.setState({submissionTasks:this.state.submissionTasks})}},{key:"handleViewComponent",value:function(){var e=this;if("createTask"===this.state.mode)return"undefined"===typeof(new A.a).get("user")&&this.props.onlogoutClick(),i.a.createElement(K,{submissionTasks:this.state.submissionTasks,reviewTasks:this.state.reviewTasks,update:this.updateArray.bind(this),submissions:this.state.submissions,mode:this.state.mode,viewHome:function(){return e.handleHomeClick()},onclickLogout:function(){return e.props.onlogoutClick()}});if("viewSubmissionSummary"===this.state.mode)return i.a.createElement(_,{specificSubmissions:this.state.specificSubmissions,currentSTask:this.state.currentSubmissionTask,update:this.updateArray.bind(this),mode:this.state.mode,submissionTasks:this.state.submissionTasks,viewHome:function(){return e.handleHomeClick()},onclickLogout:function(){return e.props.onlogoutClick()}});if("viewReviewSummary"===this.state.mode)return i.a.createElement(Q,{specificReviews:this.state.specificReviews,currentRTask:this.state.currentReviewTask,specSubmissions:this.state.specSubmissions,specAssignments:this.state.specAssignments,update:this.updateArray.bind(this),mode:this.state.mode,reviewTasks:this.state.reviewTasks,viewHome:function(){return e.handleHomeClick()},onclickLogout:function(){return e.props.onlogoutClick()}});var t=this.state.submissionTasks.map((function(t,n,a){return i.a.createElement(H.a.Item,{onClick:function(n){return e.handleSubmissionTaskClick(n,t)},key:"sstasks".concat(n),active:t===e.state.currentSubmissionTask},t["task-name"])})),n=this.state.reviewTasks.map((function(t,n,a){return i.a.createElement(H.a.Item,{onClick:function(n){return e.handleReviewTaskClick(n,t)},key:"rrtasks".concat(n),active:t===e.state.currentReviewTask},t["peer-review-for"])}));return i.a.createElement("div",null,i.a.createElement(f.a,{placeholder:!0,style:{overflow:"auto",minHeight:230,maxHeight:330,minWidth:200,marginLeft:"10em",marginTop:"3em",marginRight:"10em"}},i.a.createElement(p.a,null,i.a.createElement(I.a,{name:"tasks",circular:!0,inverted:!0,color:"blue"}),i.a.createElement(p.a.Content,null,"You have the created the following assignments to submit. Click on each to view progress.")),i.a.createElement(H.a,null,t)),i.a.createElement(f.a,{placeholder:!0,style:{overflow:"auto",minHeight:230,maxHeight:330,minWidth:200,marginLeft:"10em",marginTop:"3em",marginRight:"10em"}},i.a.createElement(p.a,null,i.a.createElement(I.a,{name:"tasks",circular:!0,inverted:!0,color:"blue"}),i.a.createElement(p.a.Content,null,"You have created the following review tasks to submit. Click on each to view progress. ")),i.a.createElement(H.a,null,n)))}},{key:"handleSubmissionTaskClick",value:function(e,t){if("undefined"===typeof(new A.a).get("user"))this.props.onlogoutClick();else{var n=this.state.submissions.filter((function(e,n,a){return e["assignment-name"]===t["task-name"]}));this.setState({mode:"viewSubmissionSummary",currentSubmissionTask:t,specificSubmissions:n})}}},{key:"handleCreateTaskClick",value:function(e){"undefined"===typeof(new A.a).get("user")?this.props.onlogoutClick():this.setState({mode:"createTask"})}},{key:"handleReviewTaskClick",value:function(e,t){if("undefined"===typeof(new A.a).get("user"))this.props.onlogoutClick();else{var n=this.state.reviews.filter((function(e,n,a){return e["assignment-name"]===t["peer-review-for"]})),a=this.state.submissions.filter((function(e,n,a){return e["assignment-name"]===t["peer-review-for"]})),i=this.state.studentAssignment.find((function(e,n,a){return e["peer-review-for"]===t["peer-review-for"]}));this.setState({mode:"viewReviewSummary",currentReviewTask:t,specificReviews:n,specSubmissions:a,specAssignments:i})}}},{key:"handleHomeClick",value:function(){var e=this;fetch("/submissionTask",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({submissionTasks:t.submissionTasks})})),fetch("/reviewTask",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({reviewTasks:t.reviewTasks})})),fetch("/studentAssignment/",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(e){return e.json()})).then((function(t){e.setState({studentAssignment:t.studentAssignment})})),this.setState({mode:"",currentSubmissionTask:"",currentReviewTask:""})}},{key:"render",value:function(){var e=this,t=this.state.submissionTasks.map((function(t,n,a){return i.a.createElement(M.a.Item,{onClick:function(n){return e.handleSubmissionTaskClick(n,t)},key:"stasks".concat(n),active:t===e.state.currentSubmissionTask},t["task-name"])})),n=this.state.reviewTasks.map((function(t,n,a){return i.a.createElement(M.a.Item,{onClick:function(n){return e.handleReviewTaskClick(n,t)},key:"rtasks".concat(n),active:t===e.state.currentReviewTask},t["peer-review-for"])}));return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement(H.a,{fixed:"top",fluid:!0,stackable:!0,inverted:!0},i.a.createElement(H.a.Item,{as:"h4",header:!0,position:"right",onClick:function(){return e.handleHomeClick()}},i.a.createElement(I.a,{name:"home"}),"Peer Review System"),i.a.createElement(H.a.Item,{as:"a",position:"right"},"Welcome, ".concat(this.props.netId," -- Instructor")," "),i.a.createElement(H.a.Item,{as:"a",position:"right","margin-right":"150px",onClick:this.props.onlogoutClick},i.a.createElement(I.a,{name:"sign-out"}),"Logout"))),i.a.createElement("div",{style:{marginLeft:10,marginRight:10,minWidth:550,marginTop:50}},i.a.createElement(h.a,{stackable:!0},i.a.createElement(h.a.Column,null,i.a.createElement(h.a.Row,null,i.a.createElement(H.a,{fluid:!0,stackable:!0},i.a.createElement(M.a,{button:!0,color:"teal",text:"Submission tasks",labeled:!0,className:"icon",floating:!0,icon:"tasks"},i.a.createElement(M.a.Menu,null,t)),i.a.createElement(M.a,{button:!0,text:"Review tasks",labeled:!0,className:"icon",floating:!0,icon:"tasks"},i.a.createElement(M.a.Menu,null,n)),i.a.createElement(H.a.Item,{as:"a",position:"right",onClick:function(t){return e.handleCreateTaskClick(t)},active:"createTask"===this.state.mode,color:"blue"},"Create task"))),i.a.createElement(h.a.Row,null,this.handleViewComponent())))))}}]),t}(i.a.Component),Z=function(e){function t(e){var n;Object(o.a)(this,t),n=Object(u.a)(this,Object(m.a)(t).call(this,e));var a=new A.a,i=a.get("user");return"undefined"!==typeof a.get("user")?n.state={netId:i.netId,role:i.role,firstName:i.firstName,lastName:i.lastName}:n.state={netId:"",password:"",role:"",message:""},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleChange",value:function(e){var t=e.target,n=t.value,a=t.name;this.setState(Object(c.a)({},a,n))}},{key:"login",value:function(){var e=this,t={netId:this.state.netId,password:this.state.password};fetch("/login",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(t){t.netId&&t.netId===e.state.netId?"instructor"===t.role?e.setState({role:t.role,firstName:t.firstName,lastName:t.lastName}):"student"===t.role?e.setState({role:t.role,firstName:t.firstName,lastName:t.lastName}):e.setState({role:"none"}):e.setState({netId:"",password:"",message:t.message,firstName:"",lastName:""})}))}},{key:"logout",value:function(){var e=this;fetch("/logout",{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((function(t){e.setState({netId:"",password:"",role:"",message:""})}))}},{key:"render",value:function(){var e=this;return""===this.state.role?i.a.createElement(h.a,{textAlign:"center",style:{height:"100vh"},verticalAlign:"middle"},i.a.createElement(h.a.Column,{style:{maxWidth:450}},i.a.createElement(p.a,{as:"h2",color:"blue",textAlign:"center"},"Log-in to your account"),i.a.createElement(v.a,{size:"large"},i.a.createElement(f.a,{stacked:!0},i.a.createElement(v.a.Input,{fluid:!0,icon:"user",iconPosition:"left",placeholder:"Net ID",name:"netId",value:this.state.netId,onChange:function(t){return e.handleChange(t)}}),i.a.createElement(v.a.Input,{fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",name:"password",value:this.state.password,onChange:function(t){return e.handleChange(t)}}),i.a.createElement(b.a,{type:"button",color:"blue",onClick:function(){return e.login()},fluid:!0,size:"large"},"Login"))),i.a.createElement(k.a,null,i.a.createElement(p.a,{as:"h4",color:"red"},this.state.message),"Having trouble ? Contact the Instructor"))):"instructor"===this.state.role?i.a.createElement(X,{netId:this.state.netId,role:this.state.role,onlogoutClick:function(){return e.logout()}}):"student"===this.state.role?i.a.createElement(q,{netId:this.state.netId,role:this.state.role,onlogoutClick:function(){return e.logout()},firstName:this.state.firstName,lastName:this.state.lastName}):"none"===this.state.role?i.a.createElement("div",null,"not authorized"):void 0}}]),t}(i.a.Component);r.a.render(i.a.createElement(Z,null),document.getElementById("root"))}},[[279,1,2]]]);
//# sourceMappingURL=main.7a504856.chunk.js.map